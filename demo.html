<!doctype html>
<meta charset='utf-8'>
<html>
  <head>
    <title>play-slam demo</title>
    <script src="../webcomponentsjs/webcomponents-lite.js"></script>
    <link rel="import" href="play-slam.html">
    <link rel="import" href="../mdl-template-dash/mdl-template-dash.html">
    <link rel="import" href="../firebase-ui-auth/firebase-ui-auth.html">
    <script src="https://www.gstatic.com/firebasejs/3.6.10/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyBvR5RhKao81RcCy05BAbDFdBDe6jvbUJg",
        authDomain: "slam-5df8b.firebaseapp.com",
        databaseURL: "https://slam-5df8b.firebaseio.com",
        storageBucket: "slam-5df8b.appspot.com",
        messagingSenderId: "994856518437"
      }
      firebase.initializeApp(config)
    </script>
  </head>
  <body>
    <template is="dom-bind" id="app" app-title="Title Here">
      <mdl-template-dash start-full user="{{user}}" pages='[{"Label":"Join","Icon":"compare-arrows"},{"Label":"play","Icon":"content-copy"}]' on-logout="logout" sign-in='["GoogleAuthProvider"]'>
        <Play-page>
          <play-slam></play-slam>
        </Play-page>
        <Join-page>
          <h1>hi {{user.displayName}} list of people to play: {{list}}</h1>
        </Join-page>
        <login-page>
          <firebase-ui-auth user="{{user}}" sign-in-success-url="" id="auth"></firebase-ui-auth>
        </login-page>
      </mdl-template-dash>
    </template>
  </body>
    <script>
      (function (document) {
        'use strict';
        var app = document.querySelector('#app')
        app.logout = function () {
          app.$.auth.signOut()
        }
        app.properties.list = {computed:"setList(user.displayName)"}
        app.setList = function(displayName) {
          var name = displayName.split(" ")[0]
          var sessionsRef = firebase.database().ref("sessions")
          sessionsRef.push({
            joinAt: firebase.database.ServerValue.TIMESTAMP,
            name: name,
          })
          
        }
      })(document);
    </script>
</html>
